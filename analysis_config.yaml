# Analysis Configuration
# Version: 3.0 - Factor number settings added

# ===== DATA SOURCE =====
data_source:
<<<<<<< HEAD
  dataset: items_28    
=======
  dataset: items_30    
>>>>>>> d3156e9fd2ccd5bd7f541df5bab046029e08ac55
                       # "items_30", "items_28","items_29"
                       # test data
                       # "satisficing_test_data"
                       # "efa_unit_test_clean_28items_v2"
                       # "efa_unit_test_skew_cross_28items_v2"
                       # "efa_unit_test_collinear_28items
                       # items_28-Q07
                       # items_30-Q19

# ===== GLOBAL SETTINGS =====
global:
  scale:
    min: 1
    max: 4
  item_pattern: "^Q\\d{2}$"
  
# Data key definitions
data_keys:
  items_30: "患者ID"
  items_29: "患者ID"  
  items_28: "患者ID"
  items_28-Q07: "患者ID"
  items_30-Q19: "患者ID"  
  rehab: "患者ID"
  interrater: "患者ID"
  #
  satisficing_test_data: "患者ID"
  efa_unit_test_clean_28items_v2: "患者ID"
  efa_unit_test_skew_cross_28items_v2: "患者ID"
  efa_unit_test_collinear_28items: "患者ID"
  
# ===== ANALYSIS SPECIFIC =====
gp_analysis:
  cutoff_percentile: 0.27

correlation_analysis:
  use: "pairwise.complete.obs"
  # Note: Both Polychoric and Pearson correlations are calculated
  # MIIC calculation uses psych::alpha() for both methods
  # Item-Total correlation always uses Pearson (via psych::alpha)

#item_total_analysis:
#  enable_subscales: true
#  self-management_skills:
#    name: "Self-management Skills"
#    items: ["Q04","Q05", "Q06", "Q09", "Q12", "Q21", "Q22", "Q23"]
#  ability_to_stay_safe:
#    name: "Ability to Stay Safe"
#    items: ["Q08", "Q18", "Q19", "Q20", "Q24", "Q28"]
#  ability_to_express_ones_inner_self:
#    name: "Ability to Express One's Inner Self"
#    items: ["Q07", "Q11", "Q14", "Q25", "Q26"]
#  mental_stability:
#    name: "Mental Stability"
#    items: ["Q10", "Q13", "Q15", "Q16", "Q17", "Q27"]
#  awareness_of_illness_and_treatment_needs:
#    name: "Awareness of Illness and Treatment Needs"
#    items: ["Q01", "Q02", "Q03"]

item_total_analysis:
  enable_subscales: true
  self-management_skills:
    name: "地域活動の自己管理"
    items: ["Q04","Q05", "Q09", "Q20", "Q21", "Q22"]
  ability_to_stay_safe:
    name: "精神状態の安定性"
    items: ["Q10", "Q12", "Q14", "Q15", "Q16"]
  ability_to_express_ones_inner_self:
    name: "自分の意向や変化を周囲に表出する力"
    items: ["Q07", "Q11", "Q13", "Q24","Q25","Q30"]
  mental_stability:
    name: "病気と治療の必要性の理解"
    items: ["Q01", "Q02", "Q03"]
  awareness_of_illness_and_treatment_needs:
    name: "現時点で自分と他人への危険行動がない"
    items: ["Q26", "Q27", "Q28","Q29"]
  awareness_of_illness_and_treatment_needs2:
    name: "自分の生活の安全を保つ力"
    items: ["Q06", "Q08", "Q17","Q18","Q23"]

# ===== FACTOR NUMBER DETERMINATION =====
factor_number:
  parallel_analysis_iterations: 200
  percentile: 95

# ===== EFA SETTINGS =====
efa_settings:
  # missing: "listwise","pairwise"
  missing: "listwise"
  pd_tolerance: 1.0e-6
  # Single extraction method (psych::fa fm argument)
  # Available: "minres", "uls", "pa", "ml", "wls", "gls"
<<<<<<< HEAD
  extraction_method: "ml"
=======
  extraction_method: "pa"
>>>>>>> d3156e9fd2ccd5bd7f541df5bab046029e08ac55
  gamma_values: [0.0]
  kaiser_normalize: true
  max_iterations: 10000
  flip_factors: true
  promax_kappa_values: [3, 4]
  # Display cutoff for pattern matrix
  # null: show all values
  # numeric (e.g., 0.30): suppress absolute values below this threshold
  display_cutoff: 0.35

# ===== EFA EVALUATION SETTINGS =====
efa_evaluation:
  primary_threshold: 0.32
  cross_threshold: 0.2
  diff_threshold: 0.1
    
# REHAB subscale definitions
rehab_subscales:
  gb_subscales:
    self_care:
      name: "Self-care"
      items: ["R_Q08", "R_Q09", "R_Q10"]
    social_activity:
      name: "Social Activity"
      items: ["R_Q11", "R_Q12", "R_Q13"]
    community_skills:
      name: "Community Skills"  
      items: ["R_Q14", "R_Q15", "R_Q16"]
    speech_skills:
      name: "Speech Skills"
      items: ["R_Q17", "R_Q18", "R_Q19"]
    disturbed_speech:
      name: "Disturbed Speech"
      items: ["R_Q20", "R_Q21", "R_Q22", "R_Q23"]

# Interrater analysis
interrater_analysis:
  kappa_weight: "squared"
  bootstrap_iterations: 1000
  ac2_weights: "quadratic"

# ===== CFA Models =====
cfa_models:
  five_factor_model:
    name: "5-Factor Model"
    structure:
      self_management:
        - "Q04"
        - "Q05"
        - "Q06"
        - "Q09"
        - "Q12"
        - "Q21"
        - "Q22"
        - "Q23"
      safety_awareness:
        - "Q08"
        - "Q18"
        - "Q19"
        - "Q20"
        - "Q24"
        - "Q28"
        - "Q29"
        - "Q30"
      self_expression:
        - "Q07"
        - "Q11"
        - "Q14"
        - "Q25"
        - "Q26"
      mental_stability:
        - "Q10"
        - "Q13"
        - "Q15"
        - "Q16"
        - "Q17"
        - "Q27"
      illness_awareness:
        - "Q01"
        - "Q02"
        - "Q03"

  four_factor_model:
    name: "4-Factor Model"
    structure:
      self_management:
        - "Q04"
        - "Q05"
        - "Q06"
        - "Q09"
        - "Q12"
        - "Q21"
        - "Q22"
        - "Q23"
      safety_and_stability:
        - "Q08"
        - "Q10"
        - "Q13"
        - "Q15"
        - "Q16"
        - "Q17"
        - "Q18"
        - "Q19"
        - "Q20"
        - "Q24"
        - "Q27"
        - "Q28"
      self_expression:
        - "Q07"
        - "Q11"
        - "Q14"
        - "Q25"
        - "Q26"
